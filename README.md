## create-black

### ä¸€ã€èƒŒæ™¯ ğŸ“–

åœ¨åˆšå¼€å§‹å­¦ä¹  `React` çš„æ—¶å€™ï¼Œä½¿ç”¨çš„è„šæ‰‹æ¶å°±æ˜¯ `create-react-app`ï¼Œè™½ç„¶è¿™ä¸ªè„šæ‰‹æ¶æä¾›çš„é›¶é…ç½®ã€å¼€ç®±å³ç”¨å¾ˆé€‚åˆæ–°æ‰‹ï¼Œä½†æ˜¯è¦æƒ³å¯¹å…¶è¿›è¡Œæ‰©å±•å°±éå¸¸éº»çƒ¦ã€‚è¦æƒ³å¯¹å…¶è¿›è¡Œæ‰©å±•ä½ å¿…é¡» `eject` æˆ–è€… ä½¿ç”¨ `carco` è¿›è¡Œé…ç½®ã€‚

å°½ç®¡ `Typescript` å·²ç»æµè¡Œäº†å¾ˆä¹…ï¼Œä½†æ˜¯è¦ä»é›¶è®¾è®¡ä¸€ä¸ª `Typescript` åº“ä¾æ—§éº»çƒ¦ï¼Œæœ¬äººä¹Ÿæ›¾æœ‰è¿‡ä»é›¶æ­å»ºä¸€ä¸ª `React` ç»„ä»¶åº“çš„æƒ³æ³•ï¼Œä½†æ˜¯å¯¹ä¸€å †é™Œç”Ÿçš„é…ç½®æœ›è€Œç”Ÿç•ã€‚

`create-black` å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜åº”è¿è€Œç”Ÿçš„ï¼Œè§£å†³ä»¥ä¸Šæ‰€æœ‰é—®é¢˜ï¼Œå¼€ç®±å³ç”¨ï¼Œé›¶é…ç½® ğŸš€ğŸš€ğŸš€

### äºŒã€ç‰¹æ€§ ğŸ§°

- ğŸ“¦ é›¶é…ç½®,å¼€ç®±å³ç”¨;
- ğŸš€ ä½¿ç”¨ `axios` + `npm` çš„æ–¹å¼æ„å»ºä½ çš„é¡¹ç›®åŸºç¡€æ¨¡æ¿ï¼Œåˆå§‹åŒ–é€Ÿåº¦è¦æ¯” `create-react-app` å¿«;
- ğŸ’¯ ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œé¡¹ç›®ç»Ÿä¸€é…ç½® `Eslint`ã€`Prettier`ã€`Husky`;
- ğŸ¥‚ ä½¿ç”¨ `Rollup` æ‰“åŒ…ä½ çš„ `Typescript` åº“ï¼Œæ”¯æŒ `UMD`ã€`CJS`ã€`ESM` è¾“å‡ºæ ¼å¼ï¼Œå¹¶ç”Ÿæˆå…¨å±€ `.d.ts` æ–‡ä»¶;
- ğŸ» æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ `Rollup` é…ç½®æ‰©å±•åŸæœ‰çš„é…ç½®ï¼Œä¸ºé¡¹ç›®æ·»åŠ ç‰¹æœ‰çš„åŠŸèƒ½;
- ğŸ¥‚ ä½¿ç”¨ `Webpack` æ‰“åŒ…ä½ çš„ `Web` åº”ç”¨ç¨‹åº,å®ç°å¤šç¯å¢ƒæ‰“åŒ…éƒ¨ç½²ï¼Œä»£ç åˆ†å‰²ä¼˜åŒ–ï¼Œé…åˆå®˜æ–¹åˆ†æå·¥å…·ï¼Œå®æ—¶ä¼˜åŒ–ä»£ç ;
- ğŸ» æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ `Webpack` é…ç½®æ‰©å±•åŸæœ‰çš„é…ç½®ï¼Œä¸ºé¡¹ç›®æ·»åŠ ç‰¹æœ‰çš„åŠŸèƒ½;
- ğŸ¯ æ”¯ç”¨æˆ·è‡ªå®šä¹‰ `Babel` é…ç½®ï¼Œè®©ä½ çš„ç¨‹åºæ›´å¥å£®;
- ğŸ“• å‹å¥½çš„æ—¥å¿—è¾“å‡ºï¼Œè®©ä½ å¿«é€Ÿå®šä½é—®é¢˜æ‰€åœ¨ä»¥åŠå¢åŠ å¼€å‘ä½“éªŒ;
- åœ¨ä½¿ç”¨ `Husky` çš„æƒ…å†µä¸‹ä½¿ç”¨ `standard-version` è‡ªåŠ¨ç”Ÿæˆ `CHANGELOG` æ–‡ä»¶;
- ğŸ”¸ ç­‰ç­‰......

### ä¸‰ã€å¿«é€Ÿå¼€å§‹ ğŸš©

```
npx create-black my-app
cd my-app
npm start
```

å¦‚æœä½ ä¹‹å‰å·²ç»é€šè¿‡ `npm install -g create-black` å…¨å±€å®‰è£…äº† `create-black`ï¼Œæˆ‘ä»¬å»ºè®®ä½ ä½¿ç”¨ `npm uninstall -g create-black` æˆ– `yarn global remove create-black` æ¥å¸è½½è¿™ä¸ªåŒ…ï¼Œä»¥ç¡®ä¿ npx æ€»æ˜¯ä½¿ç”¨æœ€æ–°çš„ç‰ˆæœ¬ã€‚

å½“ä½ åœ¨ç»ˆç«¯ä¸­è¾“å…¥ `npx create-black my-app` æ—¶ï¼Œæ§åˆ¶å°ä¼šæœ‰ä»¥ä¸‹é€‰é¡¹åŠŸèƒ½é€‰æ‹©:

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b1423eca147545c698bec5b7f30f2da2~tplv-k3u1fbpfcp-zoom-1.image)

`create-black` ä¼šæ ¹æ®ä½ çš„åˆ›å»ºä¸åŒçš„åº”ç”¨ç¨‹åºï¼Œè¿™äº›åº”ç”¨ç¨‹åºéƒ½æ˜¯å¼€ç®±å³ç”¨ï¼Œæ— éœ€é…ç½®ï¼Œå…¶ä¸­:

- `common-lib`ï¼šä¸€ä¸ªåŸºç¡€çš„ `Typescript` åº“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥æ¨¡æ¿æ¥ç¼–å†™ä¸€ä¸ªç±»ä¼¼äº `lodash` çš„å·¥å…·åº“;
- `react-ui`: ä¸ºä½ å¿«é€Ÿåˆ›å»ºä¸€ä¸ª `react` ç»„ä»¶åº“ï¼Œå†…ç½® `storybook` è®©ä½ å¿«é€Ÿç¼–å†™ä½ çš„ç»„ä»¶åº“æ–‡æ¡£ï¼Œå¹¶ä¸”ä½¿ç”¨ `standard-version` è‡ªåŠ¨ä¸ºä½ ç”Ÿæˆ `CHANGELOG` æ–‡ä»¶;
- å‰©ä¸‹çš„å››ä¸ªéƒ½æ˜¯ä¸ºä½ åˆ›å»ºä¸ç”¨çš„ `web` åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `vue` åŒæ—¶æ”¯æŒ `.vue` å’Œ `.tsx` çš„è¯­æ³•ã€‚

å¦‚æœé¡¹ç›®åˆ›å»ºæˆåŠŸï¼Œä¼šæœ‰å¦‚ä¸‹æ•ˆæœå›¾æ‰€ç¤º:

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fe46e77448d54c14aebf4557db949883~tplv-k3u1fbpfcp-zoom-1.image)


### å››ã€ åˆ›å»ºåº”ç”¨ç¨‹åº ğŸ“•

è¦åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€:

#### NPX

```
npx create-black my-app
```

#### NPM

```
npm init neat my-app
```

#### YARN

```
yarn create neat my-app
```

å®ƒå°†åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º my-app çš„ç›®å½•ã€‚
åœ¨è¯¥ç›®å½•ä¸­ï¼Œå®ƒå°†æ ¹æ®ä½ æ‰€é€‰æ‹©çš„é¡¹ç›®ç±»å‹ç”Ÿæˆä¸åŒçš„åˆå§‹é¡¹ç›®ç»“æ„å¹¶æ ¹æ®ä½ æ‰€é€‰æ‹©çš„åŒ…ç®¡ç†å·¥å…·è¿›è¡Œå®‰è£…å¯ä¼ é€’çš„ä¾èµ–é¡¹ï¼Œä¾‹å¦‚å½“ä½ é€‰æ‹© `react-ui` æ—¶ä¼šä¸ºä½ åˆ›å»ºä¸€ä¸ªå¼€ç®±å³ç”¨çš„ç»„ä»¶åº“æ¨¡æ¿,å…·ä½“ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤º:

```
â”œâ”€â”€â”€ğŸ“ .husky/
â”‚   â”œâ”€â”€â”€ğŸ“„ commit-msg
â”‚   â””â”€â”€â”€ğŸ“„ pre-commit
â”œâ”€â”€â”€ğŸ“ .storybook/
â”‚   â”œâ”€â”€â”€ğŸ“„ main.js
â”‚   â””â”€â”€â”€ğŸ“„ preview.js
â”œâ”€â”€â”€ğŸ“ .vscode/
â”‚   â””â”€â”€â”€ğŸ“„ settings.json
â”œâ”€â”€â”€ğŸ“ example/
â”‚   â”œâ”€â”€â”€ğŸ“„ App.tsx
â”‚   â”œâ”€â”€â”€ğŸ“„ index.html
â”‚   â”œâ”€â”€â”€ğŸ“„ index.tsx
â”‚   â”œâ”€â”€â”€ğŸ“„ package.json
â”‚   â””â”€â”€â”€ğŸ“„ tsconfig.json
â”œâ”€â”€â”€ğŸ“ src/
â”‚   â”œâ”€â”€â”€ğŸ“ components/
â”‚   â”‚   â””â”€â”€â”€...
â”‚   â””â”€â”€â”€ğŸ“„ index.tsx
â”œâ”€â”€â”€ğŸ“ stories/
â”‚   â””â”€â”€â”€ğŸ“„ button.stories.tsx
â”œâ”€â”€â”€ğŸ“„ .eslintignore
â”œâ”€â”€â”€ğŸ“„ .eslintrc.json
â”œâ”€â”€â”€ğŸ“„ .gitignore
â”œâ”€â”€â”€ğŸ“„ .prettierignore
â”œâ”€â”€â”€ğŸ“„ .prettierrc.json
â”œâ”€â”€â”€ğŸ“„ babel.config.js
â”œâ”€â”€â”€ğŸ“„ commitlint.config.js
â”œâ”€â”€â”€ğŸ“„ package.json
â”œâ”€â”€â”€ğŸ“„ pnpm-lock.yaml
â””â”€â”€â”€ğŸ“„ tsconfig.json
```

æ— éœ€é…ç½®æˆ–å¤æ‚çš„æ–‡ä»¶å¤¹ç»“æ„ï¼Œåªæœ‰æ„å»ºåº”ç”¨ç¨‹åºæ‰€éœ€çš„æ–‡ä»¶ã€‚

å®‰è£…å®Œæˆåï¼Œä½ å¯ä»¥æ‰“å¼€ä½ çš„é¡¹ç›®æ–‡ä»¶å¤¹:

```
cd my-app
```

åœ¨æ–°åˆ›å»ºçš„é¡¹ç›®ä¸­ï¼Œæ‚¨å¯ä»¥è¿è¡Œä¸€äº›å†…ç½®å‘½ä»¤:

#### `npm start`ã€`pnpm start` æˆ–è€… `yarn start`

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ `web` ç›¸å¯¹åº”çš„é¡¹ç›®ç±»å‹ï¼Œåˆ™åœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œåº”ç”¨ç¨‹åºå¹¶è‡ªåŠ¨æ‰“å¼€ [http://localhost:3000](http://localhost:3000) åœ¨æµè§ˆå™¨ä¸­è¿›è¡ŒæŸ¥çœ‹ï¼Œå¦åˆ™åˆ™ä½¿ç”¨ `Rollup` ä¸­çš„ `watch` é’©å­åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸­ç›‘å¬æ‚¨æ–‡ä»¶çš„å˜åŒ–ã€‚

#### `npm build`ã€`pnpm build` æˆ–è€… `yarn build`

å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ `web` åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨è¯¥å‘½ä»¤åˆ™ä¼šå°†å…¶åº”ç”¨ç¨‹åºä¼˜åŒ–æ„å»ºä»¥è·å¾—æœ€ä½³æ€§èƒ½å¹¶å°†å…¶å­˜æ”¾ä¸ `dist` ç›®å½•ä¸‹ã€‚

å¦‚æœæ‚¨åœ¨é¡¹ç›®åˆå§‹åŒ–çš„æ—¶å€™é€‰æ‹©çš„ `common-lib` æˆ–è€… `react-ui`,é‚£ä¹ˆè¯¥åº”ç”¨ç¨‹åºå°†ä¼šä½¿ç”¨ `Rollup` è¿›è¡Œæ‰“åŒ…æ„å»ºï¼Œå¹¶æ ¹æ®ä½ æ‰€ä¼ å…¥çš„å‚æ•°æ„å»ºæˆä¸åŒæ ¼å¼çš„æ–‡ä»¶,å®Œæ•´å‚æ•°é…ç½®å¦‚ä¸‹æ‰€ç¤º:

```
Usage
  $ rollup-script build [options]

Options
  --target              æŒ‡å®šç›®æ ‡ç¯å¢ƒ  é»˜è®¤ä½¿ç”¨ web
  --name                æŒ‡å®šåœ¨ UMD æ¨¡å¼æ„å»ºä¸­å…¨å±€çš„åç§°
  --format              æŒ‡å®šæ¨¡å¼æ ¼å¼(cjsï¼Œesmï¼Œumd)  é»˜è®¤æ˜¯ esm

Examples
  $ rollup-script build --target node
  $ rollup-script build --name Foo
  $ rollup-script build --format cjs,esm,umd
  $ rollup-script build --format umd --name Foo
```

### Babel

æ‚¨å¯ä»¥å°†è‡ªå·±çš„ `Babel` é…ç½®æ·»åŠ åˆ°é¡¹ç›®çš„æ ¹ç›®å½•å½“ä¸­, `create-black` ä¼šå°†å…¶ä¸è‡ªå·±åŸæœ‰çš„ `Babel` è½¬æ¢åˆå¹¶å¹¶ä¸”å°†æ–°çš„é¢„è®¾å’Œæ’ä»¶æ”¾åœ¨åˆ—è¡¨çš„æœ«å°¾ã€‚

#### Example

```js
// babel.config.js

module.exports = {
  plugins: ["babel-plugin-styled-components"],
};
```

### webpack

> âš ï¸ Warning
> è¿™äº›ä¿®æ”¹æœ‰å¯èƒ½è¦†ç›– `create-black` çš„é»˜è®¤è¡Œä¸ºå’Œé…ç½®ï¼Œè¯·è°¨æ…ä½¿ç”¨!

å¦‚æœæ‚¨æƒ³æ‰©å±• `webpack` é…ç½®å·²å¢åŠ é¡¹ç›®å¯¹ä¸åŒåŠŸèƒ½çš„æ”¯æŒæˆ–è€…å¢åŠ é¡¹ç›®æ€§èƒ½ï¼Œæ‚¨å¯ä»¥åœ¨ `webpack.config.js` æ–‡ä»¶ä¸‹å¯¹ `webpack` é…ç½®è¿›è¡Œæ‰©å±•.å¹¶ä¸”æ‚¨å¯ä»¥ä½¿ç”¨ `process.env.NODE_ENV` ä»¥åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒã€‚

#### Example

```js
// webpack.config.js

const MiniCssExtractPlugin = require("mini-css-extract-plugin");
const isDevelopment = process.env.NODE_ENV === "development";

module.exports = {
  plugins: [isDevelopment && MiniCssExtractPlugin()],
};
```

### Rollup

> âš ï¸ Warning
> è¿™äº›ä¿®æ”¹æœ‰å¯èƒ½è¦†ç›– `create-black` çš„é»˜è®¤è¡Œä¸ºå’Œé…ç½®ï¼Œè¯·è°¨æ…ä½¿ç”¨!

å¦‚æœä½ é€‰æ‹©çš„é¡¹ç›®ç±»å‹æ˜¯ `common-lib` æˆ–è€… `react-ui` å¹¶ä¸”æ‚¨å¸Œæœ›æ›´æ”¹ `Rollup` é…ç½®ï¼Œå¯ä»¥åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º `rollup.config.js` çš„æ–‡ä»¶ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤º:

```js
module.exports = {
  rollup(config, options) {
    return config;
  },
};
```

#### Example

```js
const postcss = require("rollup-plugin-postcss");

module.exports = {
  rollup(config, options) {
    config.plugins.push(postcss());
    return config;
  },
};
```

